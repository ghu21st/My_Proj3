2025-08-20 17:05:48 [    INFO] [test_int_query] test_valid_csv_exist() (test_int_query.py:50)
2025-08-20 17:05:48 [    INFO] [test_int_query] test_empty_csv_exist() (test_int_query.py:55)
2025-08-20 17:05:48 [    INFO] [test_int_query] test_brainbox_api_query_ok_csv() (test_int_query.py:61)
2025-08-20 17:05:48 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-20 17:05:50 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /upload/ HTTP/1.1" 200 179 (connectionpool.py:544)
2025-08-20 17:05:50 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /athena/query HTTP/1.1" 200 628 (connectionpool.py:544)
2025-08-20 17:05:50 [    INFO] [test_int_query] {"columns":["bill_id","meter_id","usage_type","building_id","start_date","end_date"],"rows":[["b1",100,"kwh",1,"2024-01-01","2024-01-31"],["b0001",15,"water",101,"2025-02-01","2024-03-01"],["b0002",21,"electric",101,"2024-02-01","2024-03-01"],["b0003",103,"water",202,"2025-02-01","2025-03-01"],["b0003",105,"electric",202,"2025-02-01","2025-03-01"],["b0001",15,"water",101,"2025-02-01","2024-03-01"],["b0002",21,"electric",101,"2024-02-01","2024-03-01"],["b0003",103,"water",202,"2025-02-01","2025-03-01"],["b0003",105,"electric",202,"2025-02-01","2025-03-01"],["b0001",15,"water",101,"2025-02-01","2024-03-01"]],"rowcount":10} (test_int_query.py:79)
2025-08-20 17:05:50 [    INFO] [test_int_query] test_brainbox_api_query_bad_csv() (test_int_query.py:89)
2025-08-20 17:05:50 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-20 17:05:52 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /upload/ HTTP/1.1" 422 120 (connectionpool.py:544)
2025-08-20 17:05:52 [    INFO] [test_int_query] {"error":"InvalidSchema","missing":["bill_id","meter_id","usage_type","building_id","start_date","end_date"],"extra":[]}
.+error.+InvalidSchema.+missing.+building_id.+ (test_int_query.py:102)
2025-08-20 17:05:52 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /athena/query HTTP/1.1" 200 628 (connectionpool.py:544)
2025-08-20 17:05:52 [    INFO] [test_int_query] {"columns":["bill_id","meter_id","usage_type","building_id","start_date","end_date"],"rows":[["b1",100,"kwh",1,"2024-01-01","2024-01-31"],["b0001",15,"water",101,"2025-02-01","2024-03-01"],["b0002",21,"electric",101,"2024-02-01","2024-03-01"],["b0003",103,"water",202,"2025-02-01","2025-03-01"],["b0003",105,"electric",202,"2025-02-01","2025-03-01"],["b0001",15,"water",101,"2025-02-01","2024-03-01"],["b0002",21,"electric",101,"2024-02-01","2024-03-01"],["b0003",103,"water",202,"2025-02-01","2025-03-01"],["b0003",105,"electric",202,"2025-02-01","2025-03-01"],["b0001",15,"water",101,"2025-02-01","2024-03-01"]],"rowcount":10} (test_int_query.py:117)
2025-08-20 17:05:52 [    INFO] [test_int_upload] test_brainbox_api_upload_ok_csv() (test_int_upload.py:60)
2025-08-20 17:05:52 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-20 17:05:54 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /upload/ HTTP/1.1" 200 179 (connectionpool.py:544)
2025-08-20 17:05:54 [    INFO] [test_int_upload] {"status":"ok","stored":"local_state/uploads/valid_1.csv","crawler_marker":"local_state/glue/bills_crawler__1755723954__48392536bb3149d2b8e59eed3d48d955.marker","rows_inserted":3} (test_int_upload.py:73)
2025-08-20 17:05:54 [    INFO] [test_int_upload] test_brainbox_api_validate_fail_missing_col_csv() (test_int_upload.py:80)
2025-08-20 17:05:54 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-20 17:05:56 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /upload/ HTTP/1.1" 422 62 (connectionpool.py:544)
2025-08-20 17:05:56 [    INFO] [test_int_upload] {"error":"InvalidSchema","missing":["building_id"],"extra":[]} (test_int_upload.py:94)
2025-08-20 17:05:56 [    INFO] [test_int_upload] test_brainbox_api_validate_empty_csv() (test_int_upload.py:101)
2025-08-20 17:05:56 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-20 17:05:58 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /upload/ HTTP/1.1" 422 120 (connectionpool.py:544)
2025-08-20 17:05:58 [    INFO] [test_int_upload] {"error":"InvalidSchema","missing":["bill_id","meter_id","usage_type","building_id","start_date","end_date"],"extra":[]} (test_int_upload.py:115)
2025-08-20 17:05:58 [    INFO] [test_int_validate] test_valid_csv_exist() (test_int_validate.py:60)
2025-08-20 17:05:58 [    INFO] [test_int_validate] test_invalid_csv_exist() (test_int_validate.py:65)
2025-08-20 17:05:58 [    INFO] [test_int_validate] test_invalid2_csv_exist() (test_int_validate.py:70)
2025-08-20 17:05:58 [    INFO] [test_int_validate] test_empty_csv_exist() (test_int_validate.py:75)
2025-08-20 17:05:58 [    INFO] [test_int_validate] test_brainbox_api_valid_ok_csv() (test_int_validate.py:80)
2025-08-20 17:05:58 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-20 17:06:00 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /validate/ HTTP/1.1" 200 133 (connectionpool.py:544)
2025-08-20 17:06:00 [    INFO] [test_int_validate] {"message":"CSV file is valid.","columns":["bill_id","meter_id","usage_type","building_id","start_date","end_date"],"rows_checked":3} (test_int_validate.py:94)
2025-08-20 17:06:00 [    INFO] [test_int_validate] test_brainbox_api_validate_fail_missing_col_csv() (test_int_validate.py:102)
2025-08-20 17:06:00 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-20 17:06:02 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /validate/ HTTP/1.1" 422 62 (connectionpool.py:544)
2025-08-20 17:06:02 [    INFO] [test_int_validate] {"error":"InvalidSchema","missing":["building_id"],"extra":[]} (test_int_validate.py:116)
2025-08-20 17:06:02 [    INFO] [test_int_validate] test_brainbox_api_validate_fail_wrong_datatype_csv() (test_int_validate.py:123)
2025-08-20 17:06:02 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-20 17:06:04 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /validate/ HTTP/1.1" 422 71 (connectionpool.py:544)
2025-08-20 17:06:04 [    INFO] [test_int_validate] {"error":"InvalidType","row":1,"field":"meter_id","expected":"integer"} (test_int_validate.py:136)
2025-08-20 17:06:04 [    INFO] [test_int_validate] test_brainbox_api_validate_empty_csv() (test_int_validate.py:143)
2025-08-20 17:06:04 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-20 17:06:06 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /validate/ HTTP/1.1" 422 120 (connectionpool.py:544)
2025-08-20 17:06:06 [    INFO] [test_int_validate] {"error":"InvalidSchema","missing":["bill_id","meter_id","usage_type","building_id","start_date","end_date"],"extra":[]} (test_int_validate.py:157)
2025-08-20 17:06:06 [    INFO] [test_unit_upload] test_post_upload_csv_ok_one_datarow() under test_unit_upload.py (test_unit_upload.py:19)
2025-08-20 17:06:06 [    INFO] [test_unit_upload] {'status': 'ok', 'stored': 'local_state/uploads/valid_1.csv', 'crawler_marker': 'local_state/glue/bills_crawler__1755660638__9420aab4a5c44b82974c9a502e44a8d7.marker', 'rows_inserted': 1} (test_unit_upload.py:44)
2025-08-20 17:06:06 [    INFO] [test_unit_upload] test_post_upload_csv_ok_multiple_datarow() under test_unit_upload.py (test_unit_upload.py:63)
2025-08-20 17:06:06 [    INFO] [test_unit_upload] {'status': 'ok', 'stored': 'local_state/uploads/valid_1.csv', 'crawler_marker': 'local_state/glue/bills_crawler__1755660638__9420aab4a5c44b82974c9a502e44a8d7.marker', 'rows_inserted': 3} (test_unit_upload.py:90)
2025-08-20 17:06:06 [    INFO] [test_unit_upload] test_post_upload_csv_ok_zero_datarow() under test_unit_upload.py (test_unit_upload.py:109)
2025-08-20 17:06:06 [    INFO] [test_unit_upload] {'status': 'ok', 'stored': 'local_state/uploads/valid_1.csv', 'crawler_marker': 'local_state/glue/bills_crawler__1755660638__9420aab4a5c44b82974c9a502e44a8d7.marker', 'rows_inserted': 0} (test_unit_upload.py:133)
2025-08-20 17:06:06 [    INFO] [test_unit_upload] test_post_upload_csv_fail_empty_file() under test_unit_upload.py (test_unit_upload.py:191)
2025-08-20 17:06:06 [    INFO] [test_unit_upload] {'error': 'InvalidSchema', 'missing': ['bill_id', 'meter_id', 'usage_type', 'building_id', 'start_date', 'end_date'], 'extra': []} (test_unit_upload.py:214)
2025-08-20 17:06:06 [    INFO] [test_unit_upload] test_post_upload_csv_fail_missing_col() under test_unit_upload.py (test_unit_upload.py:230)
2025-08-20 17:06:06 [    INFO] [test_unit_upload] {'error': 'InvalidSchema', 'missing': ['bill_id'], 'extra': []} (test_unit_upload.py:253)
2025-08-20 17:06:06 [    INFO] [test_unit_upload] test_post_upload_csv_fail_nonexist_file() under test_unit_validate.py (test_unit_upload.py:269)
2025-08-20 17:06:06 [    INFO] [test_unit_upload] The CSV file does not exist (test_unit_upload.py:284)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_ok_one_datarow() under test_unit_validate.py (test_unit_validate.py:19)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] {'message': 'CSV file is valid.', 'columns': ['bill_id', 'meter_id', 'usage_type', 'building_id', 'start_date', 'end_date'], 'rows_checked': 1} (test_unit_validate.py:43)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_ok_multiple_datarow() under test_unit_validate.py (test_unit_validate.py:61)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] {'message': 'CSV file is valid.', 'columns': ['bill_id', 'meter_id', 'usage_type', 'building_id', 'start_date', 'end_date'], 'rows_checked': 3} (test_unit_validate.py:87)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_ok_zero_datarow() under test_unit_validate.py (test_unit_validate.py:104)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] {'message': 'CSV file is valid.', 'columns': ['bill_id', 'meter_id', 'usage_type', 'building_id', 'start_date', 'end_date'], 'rows_checked': 0} (test_unit_validate.py:128)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_fail_empty_file() under test_unit_validate.py (test_unit_validate.py:146)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] {'error': 'InvalidSchema', 'missing': ['bill_id', 'meter_id', 'usage_type', 'building_id', 'start_date', 'end_date'], 'extra': []} (test_unit_validate.py:171)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_fail_nonexist_file() under test_unit_validate.py (test_unit_validate.py:187)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] The CSV file does not exist (test_unit_validate.py:202)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_fail_missing_col_bill_id() under test_unit_validate.py (test_unit_validate.py:211)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] {'error': 'InvalidSchema', 'missing': ['bill_id'], 'extra': []} (test_unit_validate.py:235)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_fail_missing_col_meter_id() under test_unit_validate.py (test_unit_validate.py:246)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] {'error': 'InvalidSchema', 'missing': ['meter_id'], 'extra': []} (test_unit_validate.py:270)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_fail_missing_col_usage_type() under test_unit_validate.py (test_unit_validate.py:281)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] {'error': 'InvalidSchema', 'missing': ['usage_type'], 'extra': []} (test_unit_validate.py:305)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_fail_missing_col_building_id() under test_unit_validate.py (test_unit_validate.py:316)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] {'error': 'InvalidSchema', 'missing': ['building_id'], 'extra': []} (test_unit_validate.py:340)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_fail_missing_col_start_date() under test_unit_validate.py (test_unit_validate.py:351)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] {'error': 'InvalidSchema', 'missing': ['start_date'], 'extra': []} (test_unit_validate.py:375)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_fail_missing_col_end_date() under test_unit_validate.py (test_unit_validate.py:386)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] {'error': 'InvalidSchema', 'missing': ['end_date'], 'extra': []} (test_unit_validate.py:410)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_fail_wrongtype_col_bill_id() under test_unit_validate.py (test_unit_validate.py:421)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] {'error': 'InvalidType', 'row': 1, 'field': 'bill_id', 'expected': 'string'} (test_unit_validate.py:447)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_fail_wrongtype_col_meter_id() under test_unit_validate.py (test_unit_validate.py:458)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] {'error': 'InvalidType', 'row': 1, 'field': 'meter_id', 'expected': 'integer'} (test_unit_validate.py:484)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_fail_wrongtype_col_usage_type() under test_unit_validate.py (test_unit_validate.py:495)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] {'error': 'InvalidType', 'row': 1, 'field': 'usage_type', 'expected': 'string'} (test_unit_validate.py:521)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_fail_wrongtype_col_building_id() under test_unit_validate.py (test_unit_validate.py:532)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] {'error': 'InvalidType', 'row': 1, 'field': 'building_id', 'expected': 'integer'} (test_unit_validate.py:558)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_fail_wrongtype_col_start_date()) under test_unit_validate.py (test_unit_validate.py:569)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] {'error': 'InvalidType', 'row': 1, 'field': 'start_date', 'expected': 'ISO date'} (test_unit_validate.py:595)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] test_post_validate_csv_fail_wrongtype_col_end_date()) under test_unit_validate.py (test_unit_validate.py:606)
2025-08-20 17:06:06 [    INFO] [test_unit_validate] {'error': 'InvalidType', 'row': 1, 'field': 'end_date', 'expected': 'ISO date'} (test_unit_validate.py:632)
