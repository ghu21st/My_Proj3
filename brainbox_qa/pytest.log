2025-08-19 21:00:09 [    INFO] [test_int_query] test_valid_csv_exist() (test_int_query.py:54)
2025-08-19 21:00:09 [    INFO] [test_int_query] test_empty_csv_exist() (test_int_query.py:59)
2025-08-19 21:00:09 [    INFO] [test_int_query] test_brainbox_api_query_ok_csv() (test_int_query.py:65)
2025-08-19 21:00:09 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-19 21:00:11 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /upload/ HTTP/1.1" 200 179 (connectionpool.py:544)
2025-08-19 21:00:11 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /athena/query HTTP/1.1" 200 628 (connectionpool.py:544)
2025-08-19 21:00:11 [    INFO] [test_int_query] For checkinging: {"columns":["bill_id","meter_id","usage_type","building_id","start_date","end_date"],"rows":[["b1",100,"kwh",1,"2024-01-01","2024-01-31"],["b0001",15,"water",101,"2025-02-01","2024-03-01"],["b0002",21,"electric",101,"2024-02-01","2024-03-01"],["b0003",103,"water",202,"2025-02-01","2025-03-01"],["b0003",105,"electric",202,"2025-02-01","2025-03-01"],["b0001",15,"water",101,"2025-02-01","2024-03-01"],["b0002",21,"electric",101,"2024-02-01","2024-03-01"],["b0003",103,"water",202,"2025-02-01","2025-03-01"],["b0003",105,"electric",202,"2025-02-01","2025-03-01"],["b0001",15,"water",101,"2025-02-01","2024-03-01"]],"rowcount":10}
.+columns.+bill_id.+meter_id.+usage_type.+building_id.+start_date.+end_date.+
.+b0001.+15.+water.+101.+2025-02-01.+2024-03-01.+b0002.+21.+electric.+101.+2024-02-01.+2024-03-01.+rowcount.+10 (test_int_query.py:83)
2025-08-19 21:00:11 [    INFO] [test_int_query] test_brainbox_api_query_bad_csv() (test_int_query.py:93)
2025-08-19 21:00:11 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-19 21:00:13 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /upload/ HTTP/1.1" 422 120 (connectionpool.py:544)
2025-08-19 21:00:13 [    INFO] [test_int_query] {"error":"InvalidSchema","missing":["bill_id","meter_id","usage_type","building_id","start_date","end_date"],"extra":[]}
.+error.+InvalidSchema.+missing.+building_id.+ (test_int_query.py:106)
2025-08-19 21:00:13 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /athena/query HTTP/1.1" 200 628 (connectionpool.py:544)
2025-08-19 21:00:13 [    INFO] [test_int_query] {"columns":["bill_id","meter_id","usage_type","building_id","start_date","end_date"],"rows":[["b1",100,"kwh",1,"2024-01-01","2024-01-31"],["b0001",15,"water",101,"2025-02-01","2024-03-01"],["b0002",21,"electric",101,"2024-02-01","2024-03-01"],["b0003",103,"water",202,"2025-02-01","2025-03-01"],["b0003",105,"electric",202,"2025-02-01","2025-03-01"],["b0001",15,"water",101,"2025-02-01","2024-03-01"],["b0002",21,"electric",101,"2024-02-01","2024-03-01"],["b0003",103,"water",202,"2025-02-01","2025-03-01"],["b0003",105,"electric",202,"2025-02-01","2025-03-01"],["b0001",15,"water",101,"2025-02-01","2024-03-01"]],"rowcount":10}
.+columns.+bill_id.+meter_id.+usage_type.+building_id.+start_date.+end_date.+ (test_int_query.py:121)
2025-08-19 21:00:13 [    INFO] [test_int_query] 200 (test_int_query.py:122)
2025-08-19 21:00:13 [    INFO] [test_int_upload] test_valid_csv_exist() (test_int_upload.py:61)
2025-08-19 21:00:13 [    INFO] [test_int_upload] test_invalid_csv_exist() (test_int_upload.py:66)
2025-08-19 21:00:13 [    INFO] [test_int_upload] test_empty_csv_exist() (test_int_upload.py:71)
2025-08-19 21:00:13 [    INFO] [test_int_upload] test_brainbox_api_upload_ok_csv() (test_int_upload.py:76)
2025-08-19 21:00:13 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-19 21:00:15 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /upload/ HTTP/1.1" 200 179 (connectionpool.py:544)
2025-08-19 21:00:15 [    INFO] [test_int_upload] {"status":"ok","stored":"local_state/uploads/valid_1.csv","crawler_marker":"local_state/glue/bills_crawler__1755651615__8f3e20a94f874e03a6799dc8582a3407.marker","rows_inserted":2}
.+status.+ok.+stored.+local_state/uploads.+crawler_marker.+local_state/glue/bills_crawler_.* (test_int_upload.py:89)
2025-08-19 21:00:15 [    INFO] [test_int_upload] test_brainbox_api_validate_bad_csv() (test_int_upload.py:96)
2025-08-19 21:00:15 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-19 21:00:17 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /upload/ HTTP/1.1" 422 62 (connectionpool.py:544)
2025-08-19 21:00:17 [    INFO] [test_int_upload] {"error":"InvalidSchema","missing":["building_id"],"extra":[]}
.+error.+InvalidSchema.+missing.+building_id.+ (test_int_upload.py:110)
2025-08-19 21:00:17 [    INFO] [test_int_upload] test_brainbox_api_validate_empty_csv() (test_int_upload.py:117)
2025-08-19 21:00:17 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-19 21:00:19 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /upload/ HTTP/1.1" 422 120 (connectionpool.py:544)
2025-08-19 21:00:19 [    INFO] [test_int_upload] {"error":"InvalidSchema","missing":["bill_id","meter_id","usage_type","building_id","start_date","end_date"],"extra":[]}
.+error.+InvalidSchema.+missing.+building_id.+ (test_int_upload.py:131)
2025-08-19 21:00:19 [    INFO] [test_int_validate] test_valid_csv_exist() (test_int_validate.py:60)
2025-08-19 21:00:19 [    INFO] [test_int_validate] test_invalid_csv_exist() (test_int_validate.py:65)
2025-08-19 21:00:19 [    INFO] [test_int_validate] test_empty_csv_exist() (test_int_validate.py:70)
2025-08-19 21:00:19 [    INFO] [test_int_validate] test_brainbox_api_valid_ok_csv() (test_int_validate.py:75)
2025-08-19 21:00:19 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-19 21:00:21 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /validate/ HTTP/1.1" 200 133 (connectionpool.py:544)
2025-08-19 21:00:21 [    INFO] [test_int_validate] {"message":"CSV file is valid.","columns":["bill_id","meter_id","usage_type","building_id","start_date","end_date"],"rows_checked":2}
.+CSV file is valid.+.+columns.+bill_id.+meter_id.+usage_type.+building_id.+start_date.+end_date.+ (test_int_validate.py:89)
2025-08-19 21:00:21 [    INFO] [test_int_validate] test_brainbox_api_validate_bad_csv() (test_int_validate.py:97)
2025-08-19 21:00:21 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-19 21:00:23 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /validate/ HTTP/1.1" 422 62 (connectionpool.py:544)
2025-08-19 21:00:23 [    INFO] [test_int_validate] {"error":"InvalidSchema","missing":["building_id"],"extra":[]}
.+error.+InvalidSchema.+missing.+building_id.+ (test_int_validate.py:111)
2025-08-19 21:00:23 [    INFO] [test_int_validate] test_brainbox_api_validate_empty_csv() (test_int_validate.py:118)
2025-08-19 21:00:23 [   DEBUG] [urllib3.connectionpool] Starting new HTTP connection (1): localhost:8000 (connectionpool.py:241)
2025-08-19 21:00:25 [   DEBUG] [urllib3.connectionpool] http://localhost:8000 "POST /validate/ HTTP/1.1" 422 120 (connectionpool.py:544)
2025-08-19 21:00:25 [    INFO] [test_int_validate] {"error":"InvalidSchema","missing":["bill_id","meter_id","usage_type","building_id","start_date","end_date"],"extra":[]}
.+error.+InvalidSchema.+missing.+building_id.+ (test_int_validate.py:132)
